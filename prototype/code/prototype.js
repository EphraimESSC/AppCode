/*! jquery-indexeddb  v1.0.0 2013-10-30 */
(function(e){"use strict";function n(e){var n=null;switch(e){case 0:case 1:case"readwrite":case"readonly":n=e;break;default:n=u.READ_WRITE||"readwrite"}return n}var t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,r=window.IDBKeyRange||window.webkitIDBKeyRange,o=window.IDBCursor||window.webkitIDBCursor||{};o.PREV===undefined&&(o.PREV="prev"),o.NEXT===undefined&&(o.NEXT="next");var u=window.IDBTransaction||window.webkitIDBTransaction;e.extend({indexedDB:function(o,u){if(u){"number"==typeof u&&(u={version:u});var i=u.version;if(u.schema&&!i){var c=-1;for(var a in u.schema)c=c>a?c:a;i=u.version||c}}var f={request:function(n,t){return e.Deferred(function(e){try{var r="function"==typeof n?n(t):n;r.onsuccess=function(n){e.resolveWith(r,[r.result,n])},r.onerror=function(n){e.rejectWith(r,[r.error,n])},r.onblocked!==undefined&&null===r.onblocked&&(r.onblocked=function(n){var t;try{t=r.result}catch(n){t=null}e.notifyWith(r,[t,n])}),r.onupgradeneeded!==undefined&&null===r.onupgradeneeded&&(r.onupgradeneeded=function(n){e.notifyWith(r,[r.result,n])})}catch(o){o.name="exception",e.rejectWith(r,["exception",o])}})},transaction:function(e){return{objectStore:function(n){try{return f.objectStore(e.objectStore(n))}catch(t){return e.readyState!==e.DONE&&e.abort(),f.objectStore(null)}},createObjectStore:function(n,t){try{return f.objectStore(e.db.createObjectStore(n,t))}catch(r){e.readyState!==e.DONE&&e.abort()}},deleteObjectStore:function(n){try{e.db.deleteObjectStore(n)}catch(t){e.readyState!==e.DONE&&e.abort()}},abort:function(){e.abort()}}},objectStore:function(e){for(var n={},t=["add","put","get","delete","clear","count"],r=0;t.length>r;r++)n[t[r]]=function(n){return function(){return f.request(function(t){return e[n].apply(e,t)},arguments)}}(t[r]);return n.each=function(n,t,r){return f.cursor(function(){return r?e.openCursor(f.range(t),r):e.openCursor(f.range(t))},n)},n.index=function(n){return f.index(function(){return e.index(n)})},n.createIndex=function(n,t,r){return 2===arguments.length&&"string"==typeof t&&(r=arguments[1],t=null),r||(r=n),f.index(function(){return e.createIndex(r,n,t)})},n.deleteIndex=function(n){return e.deleteIndex(n)},n},range:function(n){return e.isArray(n)?1===n.length?r.only(n[0]):r.bound(n[0],n[1],n[2]===undefined?!1:n[2],n[3]===undefined?!1:n[3]):n===undefined?null:n},cursor:function(n,t){return e.Deferred(function(e){try{var r="function"==typeof n?n():n;r.onsuccess=function(n){if(!r.result)return e.resolveWith(r,[null,n]),undefined;var o={"delete":function(){return f.request(function(){return r.result["delete"]()})},update:function(e){return f.request(function(){return r.result.update(e)})},next:function(e){this.data=e},key:r.result.key,value:r.result.value};e.notifyWith(r,[o,n]);var u=t.apply(r,[o]);try{u===!1?e.resolveWith(r,[null,n]):"number"==typeof u?r.result.advance.apply(r.result,[u]):o.data?r.result["continue"].apply(r.result,[o.data]):r.result["continue"]()}catch(n){e.rejectWith(r,[r.result,n])}},r.onerror=function(n){e.rejectWith(r,[r.result,n])}}catch(o){o.type="exception",e.rejectWith(r,[null,o])}})},index:function(e){try{var n="function"==typeof e?e():e}catch(t){n=null}return{each:function(e,t,r){return f.cursor(function(){return r?n.openCursor(f.range(t),r):n.openCursor(f.range(t))},e)},eachKey:function(e,t,r){return f.cursor(function(){return r?n.openKeyCursor(f.range(t),r):n.openKeyCursor(f.range(t))},e)},get:function(e){return"function"==typeof n.get?f.request(n.get(e)):n.openCursor(f.range(e))},count:function(){if("function"==typeof n.count)return f.request(n.count());throw"Count not implemented for cursors"},getKey:function(e){return"function"==typeof n.getKey?f.request(n.getKey(e)):n.openKeyCursor(f.range(e))}}}},s=f.request(function(){return i?t.open(o,parseInt(i)):t.open(o)});return s.then(function(e){e.onversionchange=function(){u&&u.onversionchange&&u.onversionchange()!==!1||e.close()}},function(){},function(e,n){if(n&&"upgradeneeded"===n.type){if(u&&u.schema)for(var t=n.oldVersion+1;n.newVersion>=t;t++)"function"==typeof u.schema[t]&&u.schema[t].call(this,f.transaction(this.transaction));u&&"function"==typeof u.upgrade&&u.upgrade.call(this,f.transaction(this.transaction))}}),e.extend(s,{cmp:function(e,n){return t.cmp(e,n)},deleteDatabase:function(){return e.Deferred(function(e){s.then(function(n){n.close(),f.request(function(){return t.deleteDatabase(o)}).then(function(n,t){e.resolveWith(this,[n,t])},function(n,t){e.rejectWith(this,[n,t])},function(n,t){e.notifyWith(this,[n,t])})},function(n,t){e.rejectWith(this,[n,t])},function(n,t){e.notifyWith(this,[n,t])})})},transaction:function(t,r){return!e.isArray(t)&&(t=[t]),r=n(r),e.Deferred(function(e){s.then(function(n,o){var u;try{u=n.transaction(t,r),u.onabort=u.onerror=function(n){e.rejectWith(u,[n])},u.oncomplete=function(n){e.resolveWith(u,[n])}}catch(o){return o.type="exception",e.rejectWith(this,[o]),undefined}try{e.notifyWith(u,[f.transaction(u)])}catch(o){o.type="exception",e.rejectWith(this,[o])}},function(n,t){e.rejectWith(this,[t,n])},function(){})})},objectStore:function(r,i){function c(c){return e.Deferred(function(e){function a(n,t){try{t(n.objectStore(r)).then(function(n,t){e.resolveWith(this,[n,t])},function(n,t){e.rejectWith(this,[n,t])})}catch(o){o.name="exception",e.rejectWith(n,[o,o])}}h.transaction(r,n(i)).then(function(){},function(d,l){if(d.code!==d.NOT_FOUND_ERR||i!==!0&&"object"!=typeof i)e.rejectWith(this,[d,l]);else{var p=this.result;p.close(),s=f.request(function(){return t.open(o,(parseInt(p.version,10)||1)+1)}),s.then(function(t){t.onversionchange=function(){u&&u.onversionchange&&u.onversionchange()!==!1||t.close()},h.transaction(r,n(i)).then(function(){},function(n,t){e.rejectWith(this,[n,t])},function(e){a(e,c)})},function(n,t){e.rejectWith(this,[n,t])},function(n,t){if("upgradeneeded"===t.type)try{n.createObjectStore(r,i===!0?{autoIncrement:!0}:i)}catch(o){e.rejectWith(this,[o,t])}})}},function(e){a(e,c)})})}function a(e,n){return c(function(t){return t[e].apply(t,n)})}function d(e,n,t){return c(function(r){var o=r.index(n);return o[e].apply(o[e],t)})}for(var h=this,l={},p=["add","delete","get","put","clear","count","each"],y=0;p.length>y;y++)l[p[y]]=function(e){return function(){return a(e,arguments)}}(p[y]);return l.index=function(e){return{each:function(n,t,r){return d("each",e,[n,t,r])},eachKey:function(n,t,r){return d("eachKey",e,[n,t,r])},get:function(n){return d("get",e,[n])},count:function(){return d("count",e,[])},getKey:function(n){return d("getKey",e,[n])}}},l}})}}),e.indexedDB.IDBCursor=o,e.indexedDB.IDBTransaction=u,e.idb=e.indexedDB})(jQuery);
//@ sourceMappingURL=./jquery.indexeddb.min.map
!function(e,n){"function"==typeof define&&define.amd?define(["lodash"],n):"object"==typeof exports?module.exports=n(require("lodash").runInContext()):e._.mixin(n(e._))}(this,function(e){"use strict";function n(n){return e.isArray(n)?n:e.isString(n)?t(n):[]}function t(e){for(var n="",t=[],r="",d=!1,i=!1,p=!1,a=0;a<e.length;a++)if(n=e[a],i="\\"===n||"["===n||"]"===n||"."===n,i&&!d){if(p&&"]"!==n)throw new SyntaxError('unexpected "'+n+'" within brackets at character '+a+" in property path "+e);switch(n){case"\\":d=!0;break;case"]":p=!1;break;case"[":p=!0;case".":t.push(r),r=""}}else r+=n,d=!1;return""===t[0]&&t.splice(0,1),t.push(r),t}function r(n){return function(t,r){return n(t,function(n){return e.deepGet(n,r)})}}var d={deepIn:function(t,r){for(var d=n(r),i=0;i<d.length;i++){var p=d[i];if(!(e.has(t,p)||e.isObject(t)&&p in t))return!1;t=t[p]}return!0},deepHas:function(t,r){for(var d=n(r),i=0;i<d.length;i++){var p=d[i];if(!e.has(t,p))return!1;t=t[p]}return!0},deepGet:function(t,r){var d=n(r);return e.deepIn(t,d)?e.reduce(d,function(e,n){return e[n]},t):void 0},deepOwn:function(t,r){var d=n(r);return e.deepHas(t,d)?e.reduce(d,function(e,n){return e[n]},t):void 0},deepSet:function(t,r,d){var i=n(r),p=t;return e.forEach(i,function(n,t){t+1===i.length?p[n]=d:e.isObject(p[n])||(p[n]=i[t+1]%1===0?[]:{}),p=p[n]}),t},deepCall:function(n,t,r){var d=Array.prototype.slice.call(arguments,3);return e.deepApply(n,t,r,d)},deepApply:function(n,t,r,d){var i=e.deepGet(n,t);return e.isFunction(i)?i.apply(r,d):void 0},deepEscapePropertyName:function(e){return e.replace(/\\/g,"\\\\").replace(/(\.|\[|\])/g,"\\$1")},deepMapValues:function(t,r,d){var i=n(d);return!e.isObject(t)||e.isDate(t)||e.isRegExp(t)?r(t,i):e.extend({},t,e.mapValues(t,function(n,t){return e.deepMapValues(n,r,e.flatten([i,t]))}))},deepPluck:r(e.map),deepFindIndex:r(e.findIndex),deepFindLastIndex:r(e.findLastIndex),deepFirst:r(e.first),deepFlatten:r(e.flatten),deepInitial:r(e.initial),deepLast:r(e.last),deepLastIndexOf:r(e.lastIndexOf),deepRemove:r(e.remove),deepRest:r(e.rest),deepSortedIndex:r(e.sortedIndex),deepUniq:r(e.uniq),deepCountBy:r(e.countBy),deepEvery:r(e.every),deepFilter:r(e.filter),deepFind:r(e.find),deepGroupBy:r(e.groupBy),deepIndexBy:r(e.indexBy),deepMax:r(e.max),deepMin:r(e.min),deepReject:r(e.reject),deepSome:r(e.some),deepSortBy:r(e.sortBy),deepFindKey:r(e.findKey),deepFindLastKey:r(e.findLastKey)};return d.deepSetValue=d.deepSet,d.deepGetValue=d.deepGet,d.deepGetOwnValue=d.deepOwn,e.mixin(d),d});
(function(){angular.module("ui.tree",[]).constant("treeConfig",{treeClass:"angular-ui-tree",emptyTreeClass:"angular-ui-tree-empty",hiddenClass:"angular-ui-tree-hidden",nodesClass:"angular-ui-tree-nodes",nodeClass:"angular-ui-tree-node",handleClass:"angular-ui-tree-handle",placeHolderClass:"angular-ui-tree-placeholder",dragClass:"angular-ui-tree-drag",dragThreshold:3,levelThreshold:30})})();(function(){angular.module("ui.tree").factory("$uiTreeHelper",["$document","$window",function(b,a){return{nodesData:{},setNodeAttribute:function(d,c,f){var e=this.nodesData[d.$modelValue.$$hashKey];if(!e){e={};this.nodesData[d.$modelValue.$$hashKey]=e}e[c]=f},getNodeAttribute:function(d,c){var e=this.nodesData[d.$modelValue.$$hashKey];if(e){return e[c]}return null},nodrag:function(c){return(typeof c.attr("data-nodrag"))!="undefined"},eventObj:function(d){var c=d;if(d.targetTouches!==undefined){c=d.targetTouches.item(0)}else{if(d.originalEvent!==undefined&&d.originalEvent.targetTouches!==undefined){c=d.originalEvent.targetTouches.item(0)}}return c},dragInfo:function(c){return{source:c,sourceInfo:{nodeScope:c,index:c.index(),nodesScope:c.$parentNodesScope},index:c.index(),siblings:c.siblings().slice(0),parent:c.$parentNodesScope,moveTo:function(f,g,d){this.parent=f;this.siblings=g.slice(0);var e=this.siblings.indexOf(this.source);if(e>-1){this.siblings.splice(e,1);if(this.source.index()<d){d--}}this.siblings.splice(d,0,this.source);this.index=d},parentNode:function(){return this.parent.$nodeScope},prev:function(){if(this.index>0){return this.siblings[this.index-1]}return null},next:function(){if(this.index<this.siblings.length-1){return this.siblings[this.index+1]}return null},isDirty:function(){return this.source.$parentNodesScope!=this.parent||this.source.index()!=this.index},eventArgs:function(d,e){return{source:this.sourceInfo,dest:{index:this.index,nodesScope:this.parent},elements:d,pos:e}},apply:function(){var d=this.source.$modelValue;this.source.remove();this.parent.insertNode(this.index,d)}}},height:function(c){return c.prop("scrollHeight")},width:function(c){return c.prop("scrollWidth")},offset:function(c){var d=c[0].getBoundingClientRect();return{width:c.prop("offsetWidth"),height:c.prop("offsetHeight"),top:d.top+(a.pageYOffset||b[0].body.scrollTop||b[0].documentElement.scrollTop),left:d.left+(a.pageXOffset||b[0].body.scrollLeft||b[0].documentElement.scrollLeft)}},positionStarted:function(d,c){var f={};f.offsetX=d.pageX-this.offset(c).left;f.offsetY=d.pageY-this.offset(c).top;f.startX=f.lastX=d.pageX;f.startY=f.lastY=d.pageY;f.nowX=f.nowY=f.distX=f.distY=f.dirAx=0;f.dirX=f.dirY=f.lastDirX=f.lastDirY=f.distAxX=f.distAxY=0;return f},positionMoved:function(f,g,d){g.lastX=g.nowX;g.lastY=g.nowY;g.nowX=f.pageX;g.nowY=f.pageY;g.distX=g.nowX-g.lastX;g.distY=g.nowY-g.lastY;g.lastDirX=g.dirX;g.lastDirY=g.dirY;g.dirX=g.distX===0?0:g.distX>0?1:-1;g.dirY=g.distY===0?0:g.distY>0?1:-1;var c=Math.abs(g.distX)>Math.abs(g.distY)?1:0;if(d){g.dirAx=c;g.moving=true;return}if(g.dirAx!==c){g.distAxX=0;g.distAxY=0}else{g.distAxX+=Math.abs(g.distX);if(g.dirX!==0&&g.dirX!==g.lastDirX){g.distAxX=0}g.distAxY+=Math.abs(g.distY);if(g.dirY!==0&&g.dirY!==g.lastDirY){g.distAxY=0}}g.dirAx=c}}}])})();(function(){angular.module("ui.tree").controller("TreeController",["$scope","$element","$attrs","treeConfig",function(e,c,a,d){this.scope=e;e.$element=c;e.$nodesScope=null;e.$type="uiTree";e.$emptyElm=null;e.$callbacks=null;e.dragEnabled=true;e.maxDepth=0;e.dragDelay=0;e.isEmpty=function(){return(e.$nodesScope&&e.$nodesScope.$modelValue&&e.$nodesScope.$modelValue.length===0)};e.place=function(f){e.$nodesScope.$element.append(f);e.$emptyElm.remove()};e.resetEmptyElement=function(){if(e.$nodesScope.$modelValue.length===0){c.append(e.$emptyElm)}else{e.$emptyElm.remove()}};var b=function(j,k){var f=j.childNodes();for(var g=0;g<f.length;g++){k?f[g].collapse():f[g].expand();var h=f[g].$childNodesScope;if(h){b(h,k)}}};e.collapseAll=function(){b(e.$nodesScope,true)};e.expandAll=function(){b(e.$nodesScope,false)}}])})();(function(){angular.module("ui.tree").controller("TreeNodesController",["$scope","$element","$timeout","treeConfig",function(c,a,d,b){this.scope=c;c.$element=a;c.$modelValue=null;c.$nodeScope=null;c.$treeScope=null;c.$type="uiTreeNodes";c.$nodesMap={};c.nodrop=false;c.maxDepth=0;c.initSubNode=function(e){d(function(){c.$nodesMap[e.$modelValue.$$hashKey]=e})};c.destroySubNode=function(e){c.$nodesMap[e.$modelValue.$$hashKey]=null};c.accept=function(f,e){return c.$treeScope.$callbacks.accept(f,c,e)};c.isParent=function(e){return e.$parentNodesScope==c};c.hasChild=function(){return c.$modelValue.length>0};c.safeApply=function(f){var e=this.$root.$$phase;if(e=="$apply"||e=="$digest"){if(f&&(typeof(f)==="function")){f()}}else{this.$apply(f)}};c.removeNode=function(f){var e=c.$modelValue.indexOf(f.$modelValue);if(e>-1){c.safeApply(function(){c.$modelValue.splice(e,1)[0]});return f}return null};c.insertNode=function(f,e){c.safeApply(function(){c.$modelValue.splice(f,0,e)})};c.childNodes=function(){var e=[];if(c.$modelValue){for(var f=0;f<c.$modelValue.length;f++){e.push(c.$nodesMap[c.$modelValue[f].$$hashKey])}}return e};c.depth=function(){if(c.$nodeScope){return c.$nodeScope.depth()}return 0};c.outOfDepth=function(e){var f=c.maxDepth||c.$treeScope.maxDepth;if(f>0){return c.depth()+e.maxSubDepth()+1>f}return false}}])})();(function(){angular.module("ui.tree").controller("TreeNodeController",["$scope","$element","$attrs","treeConfig",function(d,b,a,c){this.scope=d;d.$element=b;d.$modelValue=null;d.$parentNodeScope=null;d.$childNodesScope=null;d.$parentNodesScope=null;d.$treeScope=null;d.$handleScope=null;d.$type="uiTreeNode";d.$$apply=false;d.collapsed=false;d.init=function(h){var g=h[0];d.$treeScope=h[1]?h[1].scope:null;d.$parentNodeScope=g.scope.$nodeScope;d.$modelValue=g.scope.$modelValue[d.$index];d.$parentNodesScope=g.scope;g.scope.initSubNode(d);b.on("$destroy",function(){g.scope.destroySubNode(d)})};d.index=function(){return d.$parentNodesScope.$modelValue.indexOf(d.$modelValue)};d.dragEnabled=function(){return !(d.$treeScope&&!d.$treeScope.dragEnabled)};d.isSibling=function(g){return d.$parentNodesScope==g.$parentNodesScope};d.isChild=function(h){var g=d.childNodes();return g&&g.indexOf(h)>-1};d.prev=function(){var g=d.index();if(g>0){return d.siblings()[g-1]}return null};d.siblings=function(){return d.$parentNodesScope.childNodes()};d.childNodesCount=function(){return d.childNodes()?d.childNodes().length:0};d.hasChild=function(){return d.childNodesCount()>0};d.childNodes=function(){return d.$childNodesScope&&d.$childNodesScope.$modelValue?d.$childNodesScope.childNodes():null};d.accept=function(h,g){return d.$childNodesScope&&d.$childNodesScope.accept(h,g)};d.remove=function(){d.$callbacks.remove();return d.$parentNodesScope.removeNode(d)};d.toggle=function(){d.collapsed=!d.collapsed};d.collapse=function(){d.collapsed=true};d.expand=function(){d.collapsed=false};d.depth=function(){var g=d.$parentNodeScope;if(g){return g.depth()+1}return 1};var f=0;var e=function(j){var k=0;var g=j.childNodes();for(var h=0;h<g.length;h++){var l=g[h].$childNodesScope;if(l){k=1;e(l)}}f+=k};d.maxSubDepth=function(){f=0;if(d.$childNodesScope){e(d.$childNodesScope)}return f}}])})();(function(){angular.module("ui.tree").controller("TreeHandleController",["$scope","$element","$attrs","treeConfig",function(d,b,a,c){this.scope=d;d.$element=b;d.$nodeScope=null;d.$type="uiTreeHandle"}])})();(function(){angular.module("ui.tree").directive("uiTree",["treeConfig","$window",function(a,b){return{restrict:"A",scope:true,controller:"TreeController",link:function(f,e,d){var g={accept:null};var c={};angular.extend(c,a);if(c.treeClass){e.addClass(c.treeClass)}f.$emptyElm=angular.element(b.document.createElement("div"));if(c.emptyTreeClass){f.$emptyElm.addClass(c.emptyTreeClass)}f.$watch("$nodesScope.$modelValue.length",function(){if(f.$nodesScope.$modelValue){f.resetEmptyElement()}},true);d.$observe("dragEnabled",function(h){var i=f.$eval(h);if((typeof i)=="boolean"){f.dragEnabled=i}});d.$observe("maxDepth",function(i){var h=f.$eval(i);if((typeof h)=="number"){f.maxDepth=h}});d.$observe("dragDelay",function(i){var h=f.$eval(i);if((typeof h)=="number"){f.dragDelay=h}});g.accept=function(i,j,h){if(j.nodrop||j.outOfDepth(i)){return false}return true};g.dropped=function(h){};g.dragStart=function(h){};g.dragMove=function(h){};g.dragStop=function(h){};g.remove=function(h){};f.$watch(d.uiTree,function(i,h){angular.forEach(i,function(k,j){if(g[j]){if(typeof k==="function"){g[j]=k}}});f.$callbacks=g},true)}}}])})();(function(){angular.module("ui.tree").directive("uiTreeNodes",["treeConfig","$window",function(a){return{require:["ngModel","?^uiTreeNode","^uiTree"],restrict:"A",scope:true,controller:"TreeNodesController",link:function(f,d,c,i){var b={};angular.extend(b,a);if(b.nodesClass){d.addClass(b.nodesClass)}var h=i[0];var e=i[1];var g=i[2];if(e){e.scope.$childNodesScope=f;f.$nodeScope=e.scope}else{g.scope.$nodesScope=f}f.$treeScope=g.scope;if(h){h.$render=function(){if(!h.$modelValue||!angular.isArray(h.$modelValue)){f.$modelValue=[]}f.$modelValue=h.$modelValue}}c.$observe("maxDepth",function(k){var j=f.$eval(k);if((typeof j)=="number"){f.maxDepth=j}});c.$observe("nodrop",function(j){f.nodrop=((typeof j)!="undefined")});c.$observe("horizontal",function(j){f.horizontal=((typeof j)!="undefined")})}}}])})();(function(){angular.module("ui.tree").directive("uiTreeNode",["treeConfig","$uiTreeHelper","$window","$document","$timeout",function(a,c,e,d,b){return{require:["^uiTreeNodes","^uiTree"],restrict:"A",controller:"TreeNodeController",link:function(i,l,v,m){var E={};angular.extend(E,a);if(E.nodeClass){l.addClass(E.nodeClass)}i.init(m);i.collapsed=!!c.getNodeAttribute(i,"collapsed");v.$observe("collapsed",function(I){var H=i.$eval(I);if((typeof H)=="boolean"){i.collapsed=H}});i.$watch("collapsed",function(H){c.setNodeAttribute(i,"collapsed",H);v.$set("collapsed",H)});var z="ontouchstart" in window;var G,u,h,o;var g,k,D;var q=null;var t;var j=null;var s=document.body,r=document.documentElement,w,n;var C=function(L){if(!z&&(L.button==2||L.which==3)){return}if(L.uiTreeDragging||(L.originalEvent&&L.originalEvent.uiTreeDragging)){return}var M=angular.element(L.target);var K=M.scope();if(!K||!K.$type){return}if(K.$type!="uiTreeNode"&&K.$type!="uiTreeHandle"){return}if(K.$type=="uiTreeNode"&&K.$handleScope){return}while(M&&M[0]&&M[0]!=l){if(c.nodrag(M)){return}M=M.parent()}L.uiTreeDragging=true;if(L.originalEvent){L.originalEvent.uiTreeDragging=true}L.preventDefault();var J=c.eventObj(L);u=true;h=c.dragInfo(i);var H=i.$element.prop("tagName");if(H.toLowerCase()==="tr"){g=angular.element(e.document.createElement(H));var I=angular.element(e.document.createElement("td")).addClass(E.placeHolderClass);g.append(I)}else{g=angular.element(e.document.createElement(H)).addClass(E.placeHolderClass)}k=angular.element(e.document.createElement(H));if(E.hiddenClass){k.addClass(E.hiddenClass)}o=c.positionStarted(J,i.$element);g.css("height",c.height(i.$element)+"px");g.css("width",c.width(i.$element)+"px");D=angular.element(e.document.createElement(i.$parentNodesScope.$element.prop("tagName"))).addClass(i.$parentNodesScope.$element.attr("class")).addClass(E.dragClass);D.css("width",c.width(i.$element)+"px");D.css("z-index",9999);i.$element.after(g);i.$element.after(k);D.append(i.$element);d.find("body").append(D);D.css({left:J.pageX-o.offsetX+"px",top:J.pageY-o.offsetY+"px"});t={placeholder:g,dragging:D};i.$apply(function(){i.$callbacks.dragStart(h.eventArgs(t,o))});angular.element(d).bind("touchend",p);angular.element(d).bind("touchcancel",p);angular.element(d).bind("touchmove",y);angular.element(d).bind("mouseup",p);angular.element(d).bind("mousemove",y);angular.element(d).bind("mouseleave",F);w=Math.max(s.scrollHeight,s.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight);n=Math.max(s.scrollWidth,s.offsetWidth,r.clientWidth,r.scrollWidth,r.offsetWidth)};var B=function(O){var P=c.eventObj(O);var I,S,H;if(D){O.preventDefault();e.getSelection().removeAllRanges();S=P.pageX-o.offsetX;H=P.pageY-o.offsetY;if(S<0){S=0}if(H<0){H=0}if((H+10)>w){H=w-10}if((S+10)>n){S=n-10}D.css({left:S+"px",top:H+"px"});var W=window.pageYOffset||e.document.documentElement.scrollTop;var U=W+(window.innerHeight||e.document.clientHeight||e.document.clientHeight);if(U<P.pageY&&U<=w){window.scrollBy(0,10)}if(W>P.pageY){window.scrollBy(0,-10)}c.positionMoved(O,o,u);if(u){u=false;return}if(o.dirAx&&o.distAxX>=E.levelThreshold){o.distAxX=0;if(o.distX>0){I=h.prev();if(I&&!I.collapsed&&I.accept(i,I.childNodesCount())&&I.childNodes()!==null){I.$childNodesScope.$element.append(g);h.moveTo(I.$childNodesScope,I.childNodes(),I.childNodesCount())}}if(o.distX<0){var L=h.next();if(!L){var N=h.parentNode();if(N&&N.$parentNodesScope.accept(i,N.index()+1)){N.$element.after(g);h.moveTo(N.$parentNodesScope,N.siblings(),N.index()+1)}}}}var R=(c.offset(D).left-c.offset(g).left)>=E.threshold;var T=P.pageX-e.document.body.scrollLeft;var Q=P.pageY-(window.pageYOffset||e.document.documentElement.scrollTop);if(angular.isFunction(D.hide)){D.hide()}e.document.elementFromPoint(T,Q);var V=angular.element(e.document.elementFromPoint(T,Q));if(angular.isFunction(D.show)){D.show()}if(!o.dirAx){var J,M;M=V.scope();var K=false;if(!M){return}if(M.$type=="uiTree"&&M.dragEnabled){K=M.isEmpty()}if(M.$type=="uiTreeHandle"){M=M.$nodeScope}if(M.$type!="uiTreeNode"&&!K){return}if(q&&g.parent()[0]!=q.$element[0]){q.resetEmptyElement();q=null}if(K){q=M;if(M.$nodesScope.accept(i,0)){M.place(g);h.moveTo(M.$nodesScope,M.$nodesScope.childNodes(),0)}}else{if(M.dragEnabled()){V=M.$element;var X=c.offset(V);J=M.horizontal?P.pageX<(X.left+c.width(V)/2):P.pageY<(X.top+c.height(V)/2);if(M.$parentNodesScope.accept(i,M.index())){if(J){V[0].parentNode.insertBefore(g[0],V[0]);h.moveTo(M.$parentNodesScope,M.siblings(),M.index())}else{V.after(g);h.moveTo(M.$parentNodesScope,M.siblings(),M.index()+1)}}else{if(!J&&M.accept(i,M.childNodesCount())){M.$childNodesScope.$element.append(g);h.moveTo(M.$childNodesScope,M.childNodes(),M.childNodesCount())}}}}}i.$apply(function(){i.$callbacks.dragMove(h.eventArgs(t,o))})}};var x=function(H){H.preventDefault();if(D){k.replaceWith(i.$element);g.remove();D.remove();D=null;if(i.$$apply){h.apply();i.$treeScope.$apply(function(){i.$callbacks.dropped(h.eventArgs(t,o))})}else{A()}i.$treeScope.$apply(function(){i.$callbacks.dragStop(h.eventArgs(t,o))});i.$$apply=false;h=null}angular.element(d).unbind("touchend",p);angular.element(d).unbind("touchcancel",p);angular.element(d).unbind("touchmove",y);angular.element(d).unbind("mouseup",p);angular.element(d).unbind("mousemove",y);angular.element(e.document.body).unbind("mouseleave",F)};var f=function(H){if(i.dragEnabled()){C(H)}};var y=function(H){B(H)};var p=function(H){i.$$apply=true;x(H)};var F=function(H){x(H)};var A=function(){l.bind("touchstart",f);l.bind("mousedown",function(H){j=b(function(){f(H)},i.dragDelay)});l.bind("mouseup",function(){b.cancel(j)})};A();angular.element(e.document.body).bind("keydown",function(H){if(H.keyCode==27){i.$$apply=false;x(H)}})}}}])})();(function(){angular.module("ui.tree").directive("uiTreeHandle",["treeConfig","$window",function(a){return{require:"^uiTreeNode",restrict:"A",scope:true,controller:"TreeHandleController",link:function(f,d,c,e){var b={};angular.extend(b,a);if(b.handleClass){d.addClass(b.handleClass)}if(f!=e.scope){f.$nodeScope=e.scope;e.scope.$handleScope=f}}}}])})();function updateId(c,a,b){angular.forEach(b,function(d,e){if(angular.isUndefined(d.data.isIdUpdated)||d.data.isIdUpdated===false){d.data.id=(angular.isDefined(c)?c:"")+(angular.isDefined(a)?a:"")+d.data.id;d.data.diagnoseControlId=c;d.data.isIdUpdated=true}if(d.categorieschildren){updateId(c,a,d.categorieschildren)}})}function createDirective(a){b.$inject=["$compile","$templateCache","DirectiveHelperService","Data"];function b(f,c,d,e){return{restrict:"E",scope:{controls:"=",groupname:"=",parent:"=",uniqueProperty:"@",tabHierarchyHeadings:"@"},compile:function(h,g){return{pre:function(k,l,j){if(a==="r"&&k.uniqueProperty!==undefined){e.uniqueProperty=k.uniqueProperty}if(angular.isDefined(k.tabHierarchyHeadings)){e.tabHierarchyHeadings=k.tabHierarchyHeadings}if(k.controls===undefined||k.controls===null||k.controls.type===undefined){return}var i=c.get(k.controls.type);if(k.controls.type==="TabRoot"){i=c.get("Tabs")}if(k.controls.type==="RadioGroup"){d.processHierarchyLabelsForControl(k.controls,k.parent);processRadioGroup(k,e)}if(k.controls.type==="CheckboxGroup"){d.processHierarchyLabelsForContainer(k.controls,k.parent);processCheckboxGroup(k)}if(k.controls.type==="RadioButton"){k.controls.uniqueProperty=e.uniqueProperty}if(k.controls.type==="Checkbox"){d.processHierarchyLabelsForControl(k.controls,k.parent);processCheckbox(k,e,l)}if(k.controls.type==="TextInput"){d.processHierarchyLabelsForControl(k.controls,k.parent);processTextInput(k,e)}if(k.controls.type==="Text"){e.TextLabel=k.controls.properties.text;k.controls.properties.label=k.controls.properties.text}if(k.controls.type==="ToggleSwitch"){processToggleSwitch(k,e)}if(k.controls.type==="Slider"){processSlider(k,e,l)}if(k.controls.type==="Grid"){processGrid(k)}if(k.controls.type==="SelectMenu"){processSelectMenu(k,e,l)}if(k.controls.type==="Collapsible"){d.processHierarchyLabelsForContainer(k.controls,k.parent)}var m=angular.element(i);f(m)(k);l.append(m)},post:function(j,k,i){setTimeout(function(){if(j.controls.type==="Tabs"||j.controls.type==="TabRoot"){if(j.controls.type==="TabRoot"){$("#defaultPage").enhanceWithin()}k.tabs();k.data("tabsInitialized",true)}},1);if(j.controls.type==="Slider"){j.$on("$destroy",function(l){k.off("change")})}}}}}}return b};
(function () {
  'use strict';

  angular.module('ui',  [])
    .run(Run)
    .directive('r', createDirective('r'))
    .directive('content', createDirective('content'))
    .directive('radiogroup', createDirective('radiogroup'))
    .directive('checkboxgroup', createDirective('checkboxgroup'))
    .directive('tabs', createDirective('tabs'));

  Run.$inject = ['$templateCache', '$http', '$q', 'DirectiveCreateService'];
  function Run ($templateCache, $http, $q, DirectiveCreateService) {

    var templateItems = [
        //"Filterable",
        "Tabs",
        "RadioGroup",
        "CheckboxGroup",
        "RadioButton",
        "Checkbox",
        "TextInput",
        "Text",
        "ToggleSwitch",
        "Slider",
        "Grid",
        "SelectMenu",
        "Collapsible",
        "CollapsibleSet",
        "Block",
        "CategoriesButtons",
        //"CategoriesButtonsStems",
        "CategoriesRoot",
        //"CategoriesTabs",
        "Content",
        "Div",
        "TabRoot"
      ];

    var deferedArray = [];

    DirectiveCreateService.setDeferedArray(deferedArray);

    angular.forEach(templateItems, function (item, i) {
      var defer = $q.defer();
      deferedArray.push(defer.promise);

      $http.get('/app/Components/UIComponents/templates/' + item + '.html').success(function(data) {
        $templateCache.put(item, data);
        defer.resolve();
      });
    });
  }
})();
(function(){a.$inject=["$q"];function a(c){var b={};var f=null;b.createDirective=createDirective;b.setDeferedArray=e;function e(g){f=g}b.getDeferedArray=d;function d(){return f}return b}angular.module("ui").service("DirectiveCreateService",a)})();(function(){a.$inject=[];function a(){var b={restrict:"A",scope:{},link:function(d,e,c){console.log("Role Directive")}};return b}angular.module("ui").directive("dataRole",a)})();(function(){angular.module("ui").directive("enhanceUi",[function(){return{restrict:"A",link:function(c,b,a){var e=c.$eval(a.enhanceUi),d=e.event,f=e.condition;$("#defaultPage").enhanceWithin();$(b.parent()).trigger("updatelayout").listview("refresh")}}}])})();(function(){var a=function(d,b,c){var e={};e.restrict="E";e.scope={categorieschildren:"=",templateName:"@"};e.compile=function(g,f){return{pre:function(l,i,k,m){var j="",h="";h="CategoriesButtons";if(l.templateName!==undefined){h=l.templateName}j=b.get(h);var n=angular.element(j);d(n)(l);i.append(n)},post:function(j,h,i){setTimeout(function(){$('[data-type="horizontal"]').controlgroup({type:"horizontal"});h.find('[type="checkbox"]').checkboxradio()},1)}}};return e};angular.module("ui").directive("categories",["$compile","$templateCache","Data",a])})();function processRadioGroup(c,b){b.RadioGroupCount+=1;c.controls.groupname="RadioGroup"+b.RadioGroupCount;c.controls.labelPrefix=b.tabHierarchyHeadings;c.controls.name=c.controls.properties.legend;if(c.controls.properties.id===undefined){c.controls.properties.id="RadioGroup"+b.RadioGroupCount}c.$watch("controls.value",function(e,d){if(e!==undefined){var f={controlId:c.controls.properties.id,label:c.controls.labelPrefix+c.controls.properties.legend,heirarchyLabels:c.controls.heirarchyLabels,type:c.controls.type,valueLabel:c.controls.value,value:c.controls.value,labelPrefix:c.controls.labelPrefix,categoriesInfo:c.controls.categorieschildren};createControlLabel(f);b.SelectedControls[c.controls.properties.id]=f;c.controls.showCategory=true;b.sharedData.RecentlySelectedControlDetails=f;if(!b.sharedData.isControlsValuesBeingSet){openPanel()}}else{delete b.SelectedControls[c.controls.properties.id];c.controls.showCategory=false;b.sharedData.RecentlySelectedControlDetails=undefined}});var a=angular.copy(b.sharedData.classificationData);updateId(c.controls.properties.id,b.uniqueProperty,a);b.ClassificationDataAdded.push({controlId:c.controls.properties.id,uniqueProperty:b.uniqueProperty,classification:a});c.controls.categorieschildren=a}function processCheckboxGroup(a){a.controls.name=a.controls.properties.legend;angular.forEach(a.controls.children,function(c,b){c.name=a.controls.name})}function processCheckbox(c,b,d){c.controls.uniqueProperty=angular.isDefined(b.uniqueProperty)?b.uniqueProperty:"";c.controls.properties.id=c.controls.uniqueProperty+c.controls.properties.id;c.controls.labelPrefix=b.tabHierarchyHeadings;var a=angular.copy(b.sharedData.classificationData);updateId(c.controls.properties.id,b.uniqueProperty,a);b.ClassificationDataAdded.push({controlId:c.controls.properties.id,uniqueProperty:b.uniqueProperty,classification:a});c.controls.categorieschildren=a;c.$watch("controls.value",function(f,e){if(f===true&&(e===false||e===undefined)){var g={controlId:c.controls.properties.id,label:(c.controls.name?c.controls.name:""),heirarchyLabels:c.controls.heirarchyLabels,type:c.controls.type,valueLabel:c.controls.properties.label,labelPrefix:c.controls.labelPrefix,value:c.controls.value,categoriesInfo:c.controls.categorieschildren};createControlLabel(g);b.SelectedControls[c.controls.properties.id]=g;c.controls.showCategory=true;b.sharedData.RecentlySelectedControlDetails=g;if(!b.sharedData.isControlsValuesBeingSet){openPanel()}}else{if(f===false&&e===true){if(b.SelectedControls[c.controls.properties.id]!==undefined){delete b.SelectedControls[c.controls.properties.id]}c.controls.showCategory=false;b.sharedData.RecentlySelectedControlDetails=undefined}}})}function processSlider(c,b,d){c.controls.value=0;c.controls.uniqueProperty=angular.isDefined(b.uniqueProperty)?b.uniqueProperty:"";c.controls.properties.id=c.controls.uniqueProperty+c.controls.properties.id;c.controls.labelPrefix=b.tabHierarchyHeadings;d.on("change",'input[type="number"]',function(){var e=parseInt($(this).val());if(e<=0){return}c.controls.value=e;var f={controlId:c.controls.properties.id,label:c.controls.properties.label,type:c.controls.type,valueLabel:c.controls.value,labelPrefix:c.controls.labelPrefix,value:c.controls.value,categoriesInfo:c.controls.categorieschildren};createControlLabel(f);b.SelectedControls[c.controls.properties.id]=f;b.sharedData.RecentlySelectedControlDetails=f;c.controls.showCategory=true;if(!b.sharedData.isControlsValuesBeingSet){openPanel()}c.$apply()});var a=angular.copy(b.sharedData.classificationData);updateId(c.controls.properties.id,b.uniqueProperty,a);b.ClassificationDataAdded.push({controlId:c.controls.properties.id,uniqueProperty:b.uniqueProperty,classification:a});c.controls.categorieschildren=a}function processTextInput(c,b){c.controls.uniqueProperty=b.uniqueProperty;c.controls.properties.id=b.uniqueProperty+c.controls.properties.id;c.controls.labelPrefix=b.tabHierarchyHeadings;c.$watch("controls.value",function(e,d){if(e!==undefined&&e!==""){var f={controlId:c.controls.properties.id,label:c.controls.properties.label,type:c.controls.type,valueLabel:c.controls.value,labelPrefix:c.controls.labelPrefix,value:c.controls.value,categoriesInfo:c.controls.categorieschildren};createControlLabel(f);b.SelectedControls[c.controls.properties.id]=f;c.controls.showCategory=true;b.sharedData.RecentlySelectedControlDetails=undefined;b.sharedData.RecentlySelectedControlDetails=f;if(!b.sharedData.isControlsValuesBeingSet){openPanel()}}else{if(b.SelectedControls[c.controls.properties.id]!==undefined){delete b.SelectedControls[c.controls.properties.id]}c.controls.showCategory=false;b.sharedData.RecentlySelectedControlDetails=undefined}});var a=angular.copy(b.sharedData.classificationData);updateId(c.controls.properties.id,b.uniqueProperty,a);b.ClassificationDataAdded.push({controlId:c.controls.properties.id,uniqueProperty:b.uniqueProperty,classification:a});c.controls.categorieschildren=a}function processToggleSwitch(c,b){b.SliderCount+=1;if(c.controls.properties.id===undefined){c.controls.properties.id="ToggleSwitch"+b.SliderCount}if(c.controls.properties.label===undefined||c.controls.properties.label===""){c.controls.properties.label=b.TextLabel}b.TextLabel="";c.controls.uniqueProperty=angular.isDefined(b.uniqueProperty)?b.uniqueProperty:"";c.controls.properties.id=c.controls.uniqueProperty+c.controls.properties.id;c.controls.labelPrefix=b.tabHierarchyHeadings;c.controls.value="false";c.$watch("controls.value",function(e,d){if(e==="true"&&d==="false"){var f={controlId:c.controls.properties.id,label:c.controls.properties.label,type:c.controls.type,valueLabel:c.controls.properties.label1,labelPrefix:c.controls.labelPrefix,value:c.controls.value,categoriesInfo:c.controls.categorieschildren};createControlLabel(f);b.SelectedControls[c.controls.properties.id]=f;c.controls.showCategory=true;b.sharedData.RecentlySelectedControlDetails=f;if(!b.sharedData.isControlsValuesBeingSet){openPanel()}}else{if(e==="false"){delete b.SelectedControls[c.controls.properties.id];c.controls.showCategory=false;b.sharedData.RecentlySelectedControlDetails=undefined}}});var a=angular.copy(b.sharedData.classificationData);updateId(c.controls.properties.id,b.uniqueProperty,a);b.ClassificationDataAdded.push({controlId:c.controls.properties.id,uniqueProperty:b.uniqueProperty,classification:a});c.controls.categorieschildren=a}function processGrid(a){var c=a.controls;var b=c.properties&&c.properties.rows?c.properties.rows:1;if(c.properties===undefined){c.properties={}}c.properties.uiClass=GridBuilder.getGridClass(c.children,b);GridBuilder.setGridControlLabels(c)}function processSelectMenu(c,b,d){b.SelectMenuCount+=1;if(c.controls.properties.id===undefined){c.controls.properties.id="SelectMenu"+b.SelectMenuCount}c.controls.labelPrefix=b.tabHierarchyHeadings;if(c.controls.properties.options.children){c.controls.previousValue=c.controls.value=c.controls.defaultValue=c.controls.properties.options.children[0].value;c.controls.previousValueLabel=c.controls.valueLabel=c.controls.defaultValueLabel=c.controls.properties.options.children[0].text}d.on("change","select.control",function(h){var g=$(this).val();var f=$('option[value="'+g+'"]:selected',$(this)).text();if(g!==c.controls.previousValue&&g!==c.controls.defaultValue||f!==c.controls.previousValueLabel&&f!==c.controls.defaultValueLabel){c.controls.previousValue=c.controls.value;c.controls.previousValueLabel=c.controls.valueLabel;c.controls.value=g;c.controls.valueLabel=f;var i={controlId:c.controls.properties.id,label:c.controls.properties.options.label,type:c.controls.type,valueLabel:c.controls.valueLabel,labelPrefix:c.controls.labelPrefix,value:c.controls.value,categoriesInfo:c.controls.categorieschildren};createControlLabel(i);b.SelectedControls[c.controls.properties.id]=i;c.controls.showCategory=true;b.sharedData.RecentlySelectedControlDetails=i;if(!b.sharedData.isControlsValuesBeingSet){openPanel()}}else{delete b.SelectedControls[c.controls.properties.id];c.controls.showCategory=false;b.sharedData.RecentlySelectedControlDetails=undefined}c.$digest()});var a=angular.copy(b.sharedData.classificationData);updateId(c.controls.properties.id,b.uniqueProperty,a);b.ClassificationDataAdded.push({controlId:c.controls.properties.id,uniqueProperty:b.uniqueProperty,classification:a});c.controls.categorieschildren=a}function openPanel(){$("#leftpanel").panel("open");$("#closePanelButton").removeClass("ui-btn-active")}function createControlLabel(b){var a=(b.labelPrefix?b.labelPrefix:"")+(b.label?(b.labelPrefix?" : ":"")+b.label:"")+(b.heirarchyLabels&&b.heirarchyLabels.length>0?" : "+b.heirarchyLabels.join(" : "):"");b.controlLabel=a};(function(){angular.module("ui").service("DirectiveHelperService",a);function a(){var b={};b.processHierarchyLabelsForContainer=e;function e(h,f){if(!h.heirarchyLabels){h.heirarchyLabels=[]}h.heirarchyLabels=(angular.isDefined(f)&&angular.isDefined(f.heirarchyLabels)?angular.copy(f.heirarchyLabels):[]).concat(h.heirarchyLabels);var g=d(h);if(g){h.heirarchyLabels.push(g)}}function d(f){if(f.type==="Collapsible"&&f.properties.heading){return f.properties.heading}if(f.type==="CheckboxGroup"&&f.name){return f.name}}b.processHierarchyLabelsForControl=c;function c(g,f){if(angular.isUndefined(f)){return}g.heirarchyLabels=f.heirarchyLabels?angular.copy(f.heirarchyLabels):[]}return b}})();(function(){angular.module("data",[]).factory("Data",[a]).service("SharedDataService",b);function a(){return{RadioGroupCount:0,SliderCount:0,SelectMenuCount:0,TextLabel:"",SelectedControls:{},ClassificationDataAdded:[],tabHierarchyHeadings:"",sharedData:{controls:[],classificationData:[],ControlCategoriesInfo:[],RecentlySelectedControlDetails:undefined,diagnoseItems:undefined,isControlsValuesBeingSet:false}}}b.$inject=["Data"];function b(d){var c={};c.getControls=function(){return d.sharedData.controls};c.setControls=function(e){d.sharedData.controls=e};c.getClassificationData=function(){return d.sharedData.classificationData};c.setClassificationData=function(e){d.sharedData.classificationData=e};c.getClassificationData=function(){return d.sharedData.classificationData};c.setClassificationData=function(e){d.sharedData.classificationData=e};c.getControlCategoriesInfo=function(){return d.sharedData.ControlCategoriesInfo};c.setControlCategoriesInfo=function(e){d.sharedData.ControlCategoriesInfo=e};c.getRecentlySelectedControlDetails=function(){return d.sharedData.RecentlySelectedControlDetails};c.setRecentlySelectedControlDetails=function(e){d.sharedData.RecentlySelectedControlDetails=e};c.getDiagnoseItems=function(){return d.sharedData.diagnoseItems};c.setDiagnoseItems=function(e){d.sharedData.diagnoseItems=e};c.getIsControlsValuesBeingSet=function(){return d.sharedData.isControlsValuesBeingSet};c.setIsControlsValuesBeingSet=function(e){d.sharedData.isControlsValuesBeingSet=e};return c}})();(function() {
  angular.module('treePrototype', ['ui.tree', 'ui', 'data'
                                  // , 'firebase'
                                  ]);
})();
(function(){angular.module("treePrototype").service("FieldsGeneratorService",a);a.$inject=[];function a(){var f={TEXT:0,BOOLEAN:1,SELECT:2};var l={};var h=[{fieldName:"Id",fieldPath:"properties.id",fieldValue:"id1",fieldType:f.TEXT},{fieldName:"Label",fieldPath:"properties.label",fieldValue:"Label",fieldType:f.TEXT},{fieldName:"Value",fieldPath:"properties.value",fieldValue:"checkboxValue",fieldType:f.TEXT},{fieldName:"Is Checked",fieldPath:"properties.isChecked",fieldValue:false,fieldType:f.BOOLEAN,fieldOptions:[{display:"Checked",value:true},{display:"Not Checked",value:false}]},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Disabled",fieldPath:"properties.disabled",fieldValue:false,fieldType:f.BOOLEAN,fieldOptions:[{display:"Disabled",value:true},{display:"Enabled",value:false}]}];var j=[{fieldName:"Legend",fieldPath:"properties.legend",fieldValue:"",fieldType:f.TEXT},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Orientation",fieldPath:"properties.orientation",fieldValue:"vertical",fieldType:f.SELECT,fieldOptions:[{display:"horizontal",value:"horizontal"},{display:"vertical",value:"vertical"}]}];var g=[{fieldName:"Id",fieldPath:"properties.id",fieldValue:"id1",fieldType:f.TEXT},{fieldName:"Label",fieldPath:"properties.label",fieldValue:"Label",fieldType:f.TEXT},{fieldName:"Value",fieldPath:"properties.value",fieldValue:"checkboxValue",fieldType:f.TEXT},{fieldName:"Is Checked",fieldPath:"properties.isChecked",fieldValue:false,fieldType:f.BOOLEAN,fieldOptions:[{display:"Checked",value:true},{display:"Not Checked",value:false}]},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Disabled",fieldPath:"properties.disabled",fieldValue:false,fieldType:f.BOOLEAN,fieldOptions:[{display:"Disabled",value:true},{display:"Enabled",value:false}]}];var c=[{fieldName:"Text",fieldPath:"properties.text",fieldValue:"",fieldType:f.TEXT}];var m=[{fieldName:"Id",fieldPath:"properties.id",fieldValue:"id1",fieldType:f.TEXT},{fieldName:"Label",fieldPath:"properties.label",fieldValue:"Label",fieldType:f.TEXT},{fieldName:"Value",fieldPath:"properties.value",fieldValue:0,fieldType:f.TEXT},{fieldName:"Min",fieldPath:"properties.min",fieldValue:0,fieldType:f.TEXT},{fieldName:"Max",fieldPath:"properties.max",fieldValue:100,fieldType:f.TEXT},{fieldName:"Step",fieldPath:"properties.step",fieldValue:1,fieldType:f.TEXT},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Highlight",fieldPath:"properties.highlight",fieldValue:false,fieldType:f.BOOLEAN},{fieldName:"Disabled",fieldPath:"properties.disabled",fieldValue:false,fieldType:f.BOOLEAN}];var e=[{fieldName:"Id",fieldPath:"properties.id",fieldValue:"id1",fieldType:f.TEXT},{fieldName:"Value 1",fieldPath:"properties.value1",fieldValue:"no",fieldType:f.TEXT},{fieldName:"Value 2",fieldPath:"properties.value",fieldValue:"yes",fieldType:f.TEXT},{fieldName:"Label 1",fieldPath:"properties.label1",fieldValue:"No",fieldType:f.TEXT},{fieldName:"Label 2",fieldPath:"properties.label2",fieldValue:"Yes",fieldType:f.TEXT},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Disabled",fieldPath:"properties.disabled",fieldValue:false,fieldType:f.BOOLEAN}];var d=[{fieldName:"Id",fieldPath:"properties.id",fieldValue:"id1",fieldType:f.TEXT},{fieldName:"Value",fieldPath:"properties.value",fieldValue:"",fieldType:f.TEXT},{fieldName:"Type",fieldPath:"properties.type",fieldValue:"text",fieldType:f.SELECT,fieldOptions:[{display:"Text",value:"text"},{display:"Number",value:"number"},{display:"Date",value:"date"},{display:"Month",value:"month"},{display:"Week",value:"week"},{display:"Time",value:"time"},{display:"Date Time",value:"datetime-local"}]},{fieldName:"Hint",fieldPath:"properties.hint",fieldValue:"",fieldType:f.TEXT},{fieldName:"Label",fieldPath:"properties.label",fieldValue:"",fieldType:f.TEXT},{fieldName:"Native Control",fieldPath:"properties.nativecontrol",fieldValue:false,fieldType:f.BOOLEAN},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Disabled",fieldPath:"properties.disabled",fieldValue:false,fieldType:f.BOOLEAN}];var h=[{fieldName:"Id",fieldPath:"properties.id",fieldValue:"id1",fieldType:f.TEXT},{fieldName:"Label",fieldPath:"properties.label",fieldValue:"Label",fieldType:f.TEXT},{fieldName:"Value",fieldPath:"properties.value",fieldValue:"checkboxValue",fieldType:f.TEXT},{fieldName:"Is Checked",fieldPath:"properties.isChecked",fieldValue:false,fieldType:f.BOOLEAN,fieldOptions:[{display:"Checked",value:true},{display:"Not Checked",value:false}]},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Disabled",fieldPath:"properties.disabled",fieldValue:false,fieldType:f.BOOLEAN,fieldOptions:[{display:"Disabled",value:true},{display:"Enabled",value:false}]}];var i=[{fieldName:"Id",fieldPath:"properties.id",fieldValue:"id1",fieldType:f.TEXT}];var b=[{fieldName:"Id",fieldPath:"properties.id",fieldValue:"id1",fieldType:f.TEXT},{fieldName:"Heading",fieldPath:"properties.heading",fieldValue:"Collapsible Area",fieldType:f.TEXT},{fieldName:"Collapsed",fieldPath:"properties.collapsed",fieldValue:"checkboxValue",fieldType:f.BOOLEAN},{fieldName:"Icon Position",fieldPath:"properties.iconpos",fieldValue:"left",fieldType:f.SELECT,fieldOptions:[{display:"left",value:"left"},{display:"top",value:"top"},{display:"right",value:"right"},{display:"bottom",value:"bottom"},{display:"right",value:"right"}]},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Disabled",fieldPath:"properties.disabled",fieldValue:false,fieldType:f.BOOLEAN,fieldOptions:[{display:"Disabled",value:true},{display:"Enabled",value:false}]}];var k=[{fieldName:"Heading",fieldPath:"properties.heading",fieldValue:"Collapsible Area",fieldType:f.TEXT},{fieldName:"Corners",fieldPath:"properties.corners",fieldValue:false,fieldType:f.BOOLEAN},{fieldName:"Mini",fieldPath:"properties.mini",fieldValue:true,fieldType:f.BOOLEAN},{fieldName:"Enable Filter",fieldPath:"properties.filter",fieldValue:false,fieldType:f.BOOLEAN}];this.generate=function(p,o){var n=null;switch(p){case"Checkbox":case"RadioButton":n=angular.copy(h);break;case"CheckboxGroup":case"RadioGroup":n=angular.copy(j);break;case"Text":n=angular.copy(c);break;case"Slider":n=angular.copy(m);break;case"ToggleSwitch":n=angular.copy(e);break;case"TextInput":n=angular.copy(d);break;case"Filterable":n=angular.copy(i);break;case"Collapsible":n=angular.copy(b);break;case"CollapsibleSet":n=angular.copy(k);break;default:console.log("Unknown Control");return null}_.deepMapValues({properties:o},function(t,s){if(s[0]==="properties"){var r=s.join(".");var q=_.pluck(n,"fieldPath").indexOf(r);if(q!==-1){n[q].fieldValue=t}else{n.push({fieldPath:r,fieldValue:t,fieldType:p.TEXT})}}return t});angular.forEach(n,function(q,r){_.deepSet(l,q.fieldPath,q.fieldValue)});return n};this.getStructure=function(){return l}}})();(function(){angular.module("treePrototype").service("ControlsService",a);a.$inject=["$timeout","FieldsGeneratorService"];function a(t,k){var u={};var q={Checkbox:0};var n={type:"Content",zone:"content",children:[]};var s={controls:[],lists:[],selected:{list:null,item:null},currentItemIndex:0};var j=null;$.indexedDB("MyECommerceSite",{schema:{"1":function(w){var v=w.createObjectStore("catalog",{keyPath:"itemId"});v.createIndex("price")},"2":function(w){var x=w.createObjectStore("cart",{autoIncrement:true});x.createIndex("itemId");var v=w.createObjectStore("wishlist",{autoIncrement:false,keyPath:"itemId"});v.createIndex("name")}}}).done(function(){$.indexedDB("MyECommerceSite").objectStore("cart").get("serviceValues").then(function(v){if(v===undefined){$.indexedDB("MyECommerceSite").objectStore("cart").put(s,"serviceValues").then(function(){})}else{s.lists=v.lists;if(v.selected.list!==null){s.selected.list=v.selected.list}else{if(s.selected.list===null&&v.lists.length>0&&v.selected.list===null){s.selected.list=v.lists[0];o("selected")}}if(_.isNumber(v.currentItemIndex)&&!isNaN(v.currentItemIndex)){s.currentItemIndex=v.currentItemIndex}else{s.currentItemIndex=0;o("currentItemIndex")}}$("#listNameInput").focus();$("#listItemNameInput").focus();t(function(){$("#defaultPage").enhanceWithin()},100)},function(v,w){console.log("Could not add to cart")})});u.createList=d;function d(v,w){if(angular.isUndefined(w)){w=n}var x={};x.listName=v;x.controls=[w];s.lists.push(x);s.selected.list=x;o("lists");o("selected")}u.persistData=o;function o(v){var x;if(x===undefined){x="serviceValues"}var w=["controls","lists","selected","currentItemIndex"];$.indexedDB("MyECommerceSite").objectStore("cart").get(x).then(function(z){var y=z;if(v!==undefined){z[v]=s[v]}else{angular.forEach(w,function(A,B){z[A]=s[A]})}$.indexedDB("MyECommerceSite").objectStore("cart").put(y,x).then(function(){$.indexedDB("MyECommerceSite").objectStore("cart").get(x).then(function(A){},function(A,B){console.log("Could not get back updated data")})},function(A,B){console.log("Could not update data")})},function(y,z){console.log("Could not select by key:",x)})}var r=["Tabs","RadioGroup","CheckboxGroup","Grid","SelectMenu","Collapsible","Block","Content","Div","TabRoot","Collapsible","CollapsibleSet"];u.getControls=l;function l(){return s.controls}u.getSelected=m;function m(){return s.selected}function e(v){if(angular.isDefined(v.properties)&&angular.isUndefined(v.properties.isIdUpdated)||v.properties.isIdUpdated===false){v.properties.id="newItem"+(++s.currentItemIndex);v.properties.isIdUpdated=true;var w=_.filter(v.fieldsInfo,function(x){return x.fieldPath==="properties.id"});if(w.length>0){w[0].fieldValue=v.properties.id}}angular.forEach(v.children,function(x,y){e(x)});return v}u.addNewSubItem=p;function p(w,v,y){if(angular.isUndefined(w.children)){w.children=[]}var x={properties:{id:"newItem"+(++s.currentItemIndex),label:v,text:v,heading:v},type:y,children:[]};x.fieldsInfo=k.generate(y,x.properties);if(x.fieldsInfo!==null){x=$.extend(true,{},k.getStructure(),x)}w.children.push(x);s.selected.item=x;o();return x}u.isContainer=h;function h(v){return(r.indexOf(v)!==-1)}u.getServiceValues=f;function f(){return s}u.setSelectedItemScope=g;function g(v){j=v}u.getSelectedItemScope=b;function b(){return j}u.duplicateSelectedItem=c;function c(){if(j===null){return}var v=e(angular.copy(j.$modelValue));j.$parentNodeScope.$modelValue.children.push(v);o();t(function(){$("#defaultPage").enhanceWithin()},1)}u.deleteDB=i;function i(){$.indexedDB("id-app").deleteDatabase()}return u}})();(function(){angular.module("treePrototype").service("NotificationsService",a);function a(){var e=["Please select a container item to add the new item.","Please enter item label.","Please enter list name.","Selected: "];var c=[];var b={SELECT_CONTAINER_MSG:0,ENTER_ITEM_LABEL_MSG:1,ENTER_LIST_NAME_MSG:2,SELECTED_MSG:3};b.setMessage=d;function d(h,i){g();c.push(e[h]+(i?i:""))}b.getMessageArea=f;function f(){return c}b.resetMessage=g;function g(){c.splice(0,c.length)}return b}})();(function(){angular.module("treePrototype").controller("NotificationsController",a);a.$inject=["NotificationsService"];function a(d){var b=this;var c=b.model={};c.notifications=d.getMessageArea()}})();(function(){angular.module("treePrototype").controller("PreviewControlsController",a);a.$inject=["$scope","$q","$timeout","ControlsService","DirectiveCreateService"];function a(d,c,f,b,e){c.all(e.getDeferedArray()).then(function(){d.serviceValues=b.getServiceValues();f(function(){$("#defaultPage").enhanceWithin()},1)});d.updatePreview=function(){$("[data-url]").remove();window.location.reload()}}})();(function(){angular.module("treePrototype").controller("ShowJSONTreeController",a);a.$inject=["ControlsService"];function a(b){this.list=b.getServiceValues()}})();(function(){angular.module("treePrototype").controller("CreateListController",a);a.$inject=["ControlsService","ControllerModalService","NotificationsService"];function a(c,b,g){var d=this;d.listName="";var f={type:"",properties:{label:""}};var e=d.model=b.getModel("CreateListController");d.createList=function(){if(e.listName===""){g.setMessage(g.ENTER_LIST_NAME_MSG);return}e.allListNames.push(e.listName);c.createList(e.listName)}}})();(function(){angular.module("treePrototype").controller("CreateListItemController",a);a.$inject=["ControlsService","NotificationsService","ImportExportDataService","$scope","$timeout"];function a(b,h,f,d,g){var c=this;var e=c.model={};e.errorMsg="";e.itemLabel="";e.itemType="";c.add=function(){var k=b.getSelectedItemScope();if(k===null){h.setMessage(h.SELECT_CONTAINER_MSG);return}var j=k.$modelValue;if(!b.isContainer(j.type)){h.setMessage(h.SELECT_CONTAINER_MSG);return}if(e.itemLabel===""){h.setMessage(h.ENTER_ITEM_LABEL_MSG);return}h.resetMessage();b.addNewSubItem(j,e.itemLabel,e.itemType);g(function(){$("#defaultPage").enhanceWithin()},1)};c.duplicate=function(){b.duplicateSelectedItem()};c.importAction=function(){f.importData(c.csvData).then(function(j){if(j.length>0){b.createList("my list",j[0])}})};c.exportAction=function(){var o=b.getSelectedItemScope();if(o===null){h.setMessage(h.SELECT_CONTAINER_MSG);return}var m=o.$modelValue;console.log(m);c.exportData=f.exportData(m);var l={"Export.csv":{data:"\n",type:"text/csv"}};var k="Export.csv";l[k].data=c.exportData;var n=new File([l[k].data],k,{type:l[k].type,lastModified:Date.now()});var j=URL.createObjectURL(n,{oneTimeOnly:true});var p=document.createElement("a");p.href=j;p.download=k;p.textContent=k;$("#filesForDownload").append(p)};var i="Sintomas,CollapsibleSection01,Collapsible\n,Checkbox Group Name,CheckboxGroup01,CheckboxGroup\n,,Esgotamento pelo esforo,Checkbox01,Checkbox\n,,Astenia Fsica,Checkbox02,Checkbox\n,,Outro,TextInput01,TextInput\n,Alterao de Viso,CollapsibleSection02,Collapsible\n,,Hemeralopia,Checkbox09,Checkbox\n,Sudorese,Collapsible Section03,Collapsible\n,,Sudorese Profusa,Checkbox16,Checkbox\n,Temperatura,CollapsibleSection04,Collapsible\n,,Calor Dirio,Checkbox21,Checkbox\n,,Calor Noturno,Checkbox22,Checkbox\n,Memria,CollapsibleSection05,Collapsible\n,,Falta de Memorizao,Checkbox41,Checkbox\n,, Falta de Concentrao,Checkbox42,Checkbox\n";c.csvData=i}})();(function(){angular.module("treePrototype").controller("PropertiesController",a);a.$inject=["$scope","ControlsService"];function a(c,b){changedPathsArray=[];c.serviceValues=b.getServiceValues();c.saveChanges=function(){angular.forEach(changedPathsArray,function(e,d){_.deepSet(c.serviceValues.selected.item,e.path,e.value)});b.persistData();changedPathsArray.splice(0,changedPathsArray.length-1)};c.onChangeValue=function(g,d){if(changedPathsArray.length>0){var f=c.serviceValues.selected.item.fieldsInfo;var e=_.pluck(changedPathsArray,"path").indexOf(g);if(e===-1){changedPathsArray.push({path:g,value:d})}else{changedPathsArray[e].value=d}}else{changedPathsArray.push({path:g,value:d})}}}})();(function(){angular.module("treePrototype").service("ImportExportDataService",a);a.$inject=["FieldsGeneratorService","$q"];function a(e,f){var c={};var h=[];function i(m){var k=m.split("\n");var j=0;var n=0;var l=[];var o=null;angular.forEach(k,function(w,s){var q=w.split(",");if(q.length<2){return}q=_.map(q,function(x){return x.indexOf("\r")===-1?x:x.replace("\r","")});var p=_.filter(q,function(x){return x===""}).length;if(p!==j&&p!==(j+1)&&p!==(j-1)){console.log("invalid record: ",q);return}if(p===0){l.splice(0,l.length);l.push(h)}var u={};u.properties={id:q[p+1],label:q[p]};var t=q[p+2];if(angular.isDefined(t)){u.type=q[p+2];u.fieldsInfo=e.generate(u.type,u.properties);if(u.fieldsInfo!==null){u=$.extend(true,{},e.getStructure(),u)}}if(p===j){if(p===0){h.push(u)}else{var r=l.length-1;var v=l[r];v.push(u)}}else{if(p===(j+1)){if(angular.isUndefined(o.children)){o.children=[];l.push(o.children)}o.children.push(u)}else{if(p===(j-1)){l.splice(l.length-1,1);if(p===0){h.push(u)}else{var r=l.length-1;var v=l[r];v.push(u)}}}}o=u;j=p});return h}c.importData=d;function d(k){var m=f.defer();var l=".js-import-file";var j=$(l)[0].files[0];if(j===undefined){console.log("No File selected");return}fr=new FileReader();fr.onload=function(n){i(n.target.result);m.resolve(h)};fr.readAsText(j);return m.promise}function b(k,l){var j=[];angular.forEach(k,function(n){var m=[];for(var o=0;o<l;o++){m.push("")}m.push(n.properties?n.properties.label:n.type);m.push(n.properties?n.properties.id:"placeholderId");m.push(n.type+"\n");j.push(m.join(","));if(angular.isDefined(n.children)){j.push(b(n.children,l+1).join(""))}});return j}c.exportData=g;function g(j){if(!angular.isArray(j)){j=[j]}return b(j,0).join("")}return c}}());(function(){angular.module("treePrototype").service("ControllerModalService",a);a.$inject=[];function a(){var b={};var d={CreateListController:{allListNames:[],listName:""},CreateListItemController:{}};b.getModel=c;function c(e){return d[e]}return b}})();selectedScope=null;(function(){angular.module("treePrototype").controller("MainCtrl",a);a.$inject=["$scope","$q","$timeout","ControlsService","DirectiveCreateService","NotificationsService"];function a(d,c,g,b,f,h){var e=d.model={};e.serviceValues=b.getServiceValues();d.options={dragStart:function(i){},remove:function(i){console.log("remove");b.persistData()},dropped:function(j){e.selectedItemScope=j.source.nodeScope;var i=b.getServiceValues();i.selected.item=j.source.nodeScope.$modelValue;b.setSelectedItemScope(e.selectedItemScope);b.persistData();h.setMessage(h.SELECTED_MSG,j.source.nodeScope.$modelValue.type);g(function(){$("#defaultPage").enhanceWithin()},1)}};d.toggle=function(i){i.toggle();b.persistData()};d.isContainer=function(i){return b.isContainer(i)}}})();